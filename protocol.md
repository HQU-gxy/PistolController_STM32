# 靶箱和后端的通信协议共15位：
## 数据信息解释：
* 第一位：用来区分靶箱和枪的通信还有靶箱和后端的通信。0x10 是枪和靶箱 0x16是靶箱和后端。
* 第二位：用来区分信息格式  0x00是注册信息，0x0xff是退出信息，0x01是评价信息。0x10是数据信息，0x11是设置信息。
* 第三位：用来区分信息方向。0x10是上行信息，0x01是下行信息。
* 第四位和第五位是枪编号
* 第六位和第七位是靶箱编号
* 第八位是轨迹标记位：为0时代表此次数据是轨迹。为1时代表此次数据是着弹点
* 第九位是确认信息，注册信息和退出信息在靶箱端还有后端收到后要填充0x99作为回复信息。
* 第十位是当前子弹数信息。
* 第十一位十二位分别是X坐标的百分数整数，百分数小数。保留两位小数。
* 第十三位十四位分别是Y坐标的百分数整数，百分数表述。保留两位小数。
* 第十五位保留。
## 数据信息样例：
* 轨迹：`0x16 0x10 0x10 0x00 0x7b 0x01 0xc8 0x00 0x00 0x1e 0x69 0x53 0x15 0x06 0x88`
* 		 1    2    3    4    5    6    7    8    9    10   11   12   13   14   15  
* 着弹点：`0x16 0x10 0x10 0x00 0x7b 0x01 0xc8 0x01 0x00 0x1e 0x69 0x53 0x15 0x06 0x88`
* 		   1    2    3    4    5    6    7    8    9    10   11   12   13   14   15  
## 设置信息解释：
* 设置信息是下行信息，所以第三位是0x01
* 第十位是设置的子弹数
* 第十一位是语音开关（0-1）
* 第十二位是拉栓开关（0-1）
* 第十三位是后坐力开关（0-1）
* 第十四位是低电量门限（10-30）
* 第十五位是音量（取值 0- 7）
## 设置信息样例：
* 后端：`0x16 0x11 0x01 0x00 0x7b 0x01 0xc8 0x01 0x00 0x1e 0x00 0x00 0x00 0x0b 0x08`
* 		 1    2    3    4    5    6    7    8    9    10   11   12   13   14   15  
* 靶箱：`0x10 0x11 0x01 0x00 0x7b 0x01 0xc8 0x01 0x00 0x1e 0x00 0x00 0x00 0x0b 0x07`
* 		  1    2    3    4    5    6    7    8    9    10   11   12   13   14   15  
先后后端发到靶箱，再从靶箱发到后端（后续优化后端直接发到枪）。30发子弹，语音关闭，拉栓关闭，后坐力关闭，低电量门设置为10.音量设置最大。

## 整体流程
### 靶箱上电发送注册信息（未收到回复之前不断发送，每隔50ms）：
*   `0x16 0x00 0x10 0x00 0x7b 0x01 0xc8 0x00 0x00 0x00 0x00 0x00 0x00  0x00 0x88`
*     1    2    3    4    5    6    7    8    9    10   11   12   13   14   15  
### 后端回复注册信息：  
*   `0x16 0x00 0x01 0x00 0x7b 0x01 0xc8 0x00 0x99 0x00 0x00 0x00  0x00 0x00 0x88`
*     1    2    3    4    5    6    7    8    9    10   11   12   13   14   15  
### 收到回复后停止发送。靶箱等待枪发送注册信息（枪不断发送，间隔50ms），  
*   `0x10 0x00 0x10 0x00 0x7b 0x01 0xc8 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x88`  
*     1    2    3    4    5    6    7    8    9    10   11   12   13   14   15  
### 靶箱回复信息，
*   `0x10 0x00 0x01 0x00 0x7b 0x01 0xc8 0x00 0x99 0x00 0x00 0x00 0x00 0x00 0x88`
*     1    2    3    4    5    6    7    8    9    10   11   12   13   14   15  
### 收到回复后停止发送。打开摄像头，靶箱每隔50ms发送一次坐标信息。
* 轨迹信息：`0x16 0x10 0x10 0x00 0x7b 0x01 0xc8 0x00 0x00 0x1e 0x69 0x53 0x15 0x06 0x88`
*            1    2    3    4    5    6    7    8    9    10   11   12   13   14   15  
* 着弹点：`0x16 0x10 0x10 0x00 0x7b 0x01 0xc8 0x01 0x00 0x1e 0x69 0x53 0x15 0x06 0x88`
* 		   1    2    3    4    5    6    7    8    9    10   11   12   13   14   15  
### 枪长按发送退出信息，靶箱关闭摄像头，发送退出消息后端。
* 枪发送：`0x10 0x01 0x10 0x00 0x7b 0x01 0xc8 0x00 0x00 0x1e 0x69 0x53 0x15 0x06 0x88`
* 		   1    2    3    4    5    6    7    8    9    10   11   12   13   14   15  
* 靶箱回复：`0x16 0x01 0x01 0x00 0x7b 0x01 0xc8 0x00 0x99 0x1e 0x69 0x53 0x15 0x06 0x88`
* 		     1    2    3    4    5    6    7    8    9    10   11   12   13   14   15  
* 靶箱：`0x16 0x01 0x10 0x00 0x7b 0x01 0xc8 0x00 0x00 0x1e 0x69 0x53 0x15 0x06 0x88`
* 		  1    2    3    4    5    6    7    8    9    10   11   12   13   14   15  
 
 
  
 

